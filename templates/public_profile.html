{% extends layout %}
{% block content %}
<style>
  .wrap{max-width:520px;margin:0 auto;padding:14px}

  .profileCard{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:18px;
    box-shadow:0 6px 18px rgba(16,24,40,.04);
    padding:16px;
    text-align:center;
  }

  .profileAvatar{
    width:76px;height:76px;
    border-radius:999px;
    overflow:hidden;
    border:1px solid var(--softBorder);
    background: rgba(15,23,42,0.06);
    margin:2px auto 10px;
  }
  body[data-theme="dark"] .profileAvatar{background: rgba(255,255,255,0.06)}
  .profileAvatar img{width:100%;height:100%;object-fit:cover;display:block}

  .profileName{
    font-size:21px;
    font-weight:700;
    letter-spacing:-0.3px;
    line-height:1.15;
    word-break:break-word;
    margin:0 auto;
    max-width: 100%;
    display:-webkit-box;
    -webkit-line-clamp:2;
    -webkit-box-orient:vertical;
    overflow:hidden;
  }

  .profileBio{
    margin-top:10px;
    font-size:12px;
    font-weight:300;
    color:var(--muted);
    line-height:1.6;
    display:-webkit-box;
    -webkit-line-clamp:4;
    -webkit-box-orient:vertical;
    overflow:hidden;
  }

  .hobbyRow{
    margin-top:10px;
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
    color:var(--muted);
    font-size:12px;
    font-weight:300;
  }
  .hobbyItem{
    display:inline-flex;
    align-items:center;
    gap:8px;
    white-space:nowrap;
  }
  .hobbyItem svg{width:16px;height:16px;stroke-width:1.6}

  .profileSocial{
    margin-top:10px;
    display:flex;
    gap:14px;
    flex-wrap:wrap;
    justify-content:center;
    align-items:center;
  }
  .socialIcon{
    color:var(--muted);
    text-decoration:none;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    padding:2px;
  }
  .socialIcon i{font-size:15px}
  .socialIcon:hover{color:var(--text)}
  .socialIcon:active{transform:scale(.98)}

  .catRow{
    margin-top:12px;
    display:flex;
    justify-content:center;
    gap:8px;
    flex-wrap:wrap;
  }
  .catChip{
    display:inline-flex;
    align-items:center;
    gap:8px;
    padding:8px 10px;
    border-radius:999px;
    background: rgba(15,23,42,0.06);
    color: var(--text);
    font-size:12px;
    font-weight:500;
  }
  body[data-theme="dark"] .catChip{background: rgba(255,255,255,0.08)}
  .catChip svg{width:15px;height:15px;stroke-width:1.6}
  .catChip span:last-child{font-weight:500}

  .sectionTitle{
    margin:16px 2px 10px;
    font-size:12px;
    font-weight:700;
    color:var(--text);
    letter-spacing:.15px;
  }

  .postGrid{
    display:grid;
    grid-template-columns: 1fr 1fr;
    gap:12px;
  }
  .postCard{
    background:var(--card);
    border:1px solid var(--border);
    border-radius:18px;
    overflow:hidden;
    box-shadow:0 6px 18px rgba(16,24,40,.04);
    min-width:0;
  }
  .postThumb{
    width:100%;
    height:110px;
    background: rgba(15,23,42,0.06);
  }
  body[data-theme="dark"] .postThumb{background: rgba(255,255,255,0.06)}
  .postThumb img{width:100%;height:100%;object-fit:cover;display:block}

  .postBody{padding:12px;display:flex;flex-direction:column;gap:8px;min-width:0}

  .postTitle{
    font-size:13px;
    font-weight:700;
    letter-spacing:-0.2px;
    line-height:1.35;
    display:-webkit-box;
    -webkit-line-clamp:2;
    -webkit-box-orient:vertical;
    overflow:hidden;
  }

  .postExcerpt{
    font-size:12px;
    font-weight:300;
    color:var(--muted);
    line-height:1.55;
    display:-webkit-box;
    -webkit-line-clamp:2;
    -webkit-box-orient:vertical;
    overflow:hidden;
  }

  .postMetaRow{
    margin-top:2px;
    display:flex;
    justify-content:center;
    align-items:center;
    gap:10px;
    flex-wrap:wrap;
    color:var(--muted);
    font-size:11px;
    font-weight:300;
  }
  .metaItem{
    display:inline-flex;
    align-items:center;
    gap:6px;
    white-space:nowrap;
  }
  .metaItem svg{width:14px;height:14px;stroke-width:1.7}

  .pager{
    margin-top:12px;
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
  }
  .pageBtn{
    height:36px;
    padding:0 12px;
    border-radius:999px;
    border:1px solid var(--softBorder);
    background: rgba(255,255,255,0.35);
    color:var(--text);
    font-size:12px;
    font-weight:700;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:8px;
    text-decoration:none;
  }
  body[data-theme="dark"] .pageBtn{background: rgba(255,255,255,0.06)}
  .pageBtn:active{transform:scale(.98)}
  .pageBtn[disabled]{opacity:.6;cursor:not-allowed}
  .pageBtn.active{
    background: rgba(15,23,42,0.10);
    border-color: rgba(15,23,42,0.18);
  }
  body[data-theme="dark"] .pageBtn.active{
    background: rgba(255,255,255,0.10);
    border-color: rgba(255,255,255,0.16);
  }

  @media(max-width:520px){
    .postGrid{grid-template-columns:1fr}
    .postThumb{height:150px}
  }
</style>

<main class="wrap">
  <section class="profileCard">
    <div class="profileAvatar">
      <img src="{{ url_for('static', filename='uploads/' + user.profile_pic) }}" alt="Writer avatar">
    </div>

    <div class="profileName">{{ user.name or user.username }}</div>

    {% if user.bio %}
      <div class="profileBio">{{ user.bio }}</div>
    {% else %}
      <div class="profileBio">(Intro will be added by you) â€” public bio/intro will stay here. Mention what topics the writer covers.</div>
    {% endif %}

    {% if hobbies %}
      <div class="hobbyRow" aria-label="Hobbies">
        {% for hobby in hobbies[:3] %}
          <span class="hobbyItem"><span data-lucide="sparkles"></span><span>{{ hobby }}</span></span>
        {% endfor %}
      </div>
    {% endif %}

    <div class="profileSocial" aria-label="Social links">
      <a class="socialIcon" href="#" aria-label="Facebook"><i class="fa-brands fa-facebook-f"></i></a>
      <a class="socialIcon" href="#" aria-label="X"><i class="fa-brands fa-x-twitter"></i></a>
      <a class="socialIcon" href="#" aria-label="Instagram"><i class="fa-brands fa-instagram"></i></a>
      <a class="socialIcon" href="#" aria-label="YouTube"><i class="fa-brands fa-youtube"></i></a>
    </div>

    {% if categories %}
      <div class="catRow" aria-label="Categories (max 3)">
        {% for category in categories %}
          <span class="catChip"><span data-lucide="sparkles"></span><span>{{ category }}</span></span>
        {% endfor %}
      </div>
    {% endif %}
  </section>

  <div class="sectionTitle">Posts ({{ 5 if page == 1 else 10 }} per page)</div>

  <section class="postGrid">
    {% for post in posts %}
      <article class="postCard">
        <a href="{{ url_for('post_detail', post_id=post.id) }}" style="text-decoration:none; color:inherit;">
          <div class="postThumb">
            <img src="{{ url_for('static', filename='uploads/' + (post.thumbnail or 'default.jpg')) }}" alt="thumb">
          </div>
          <div class="postBody">
            <div class="postTitle">{{ post.title }}</div>
            <div class="postExcerpt">{{ post.excerpt[:100] }}...</div>
            <div class="postMetaRow">
              <span class="metaItem"><span data-lucide="clock"></span><span>{{ reading_times[post.id] }} min</span></span>
              <span class="metaItem"><span data-lucide="calendar"></span><span>{{ post.date_posted.strftime('%b %d, %Y') }}</span></span>
            </div>
          </div>
        </a>
      </article>
    {% else %}
      <div class="profileBio">No posts yet.</div>
    {% endfor %}
  </section>

  {% if total_pages > 1 %}
  <nav class="pager" aria-label="Pagination preview">
    {% for n in range(1, total_pages + 1) %}
      <a class="pageBtn {{ 'active' if n == page else '' }}" href="{{ url_for('public_profile', username=user.username, page=n) }}">{{ n }}</a>
    {% endfor %}
  </nav>
  {% endif %}
</main>

<script>
  lucide.createIcons();
</script>
{% endblock %}
